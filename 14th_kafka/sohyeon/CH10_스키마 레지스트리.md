# 10ì¥ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬
## 10.1 ìŠ¤í‚¤ë§ˆì˜ ê°œë…ê³¼ ìœ ìš©ì„±
- **ì¹´í”„ì¹´ì— ìŠ¤í‚¤ë§ˆê°€ ì—†ë‹¤ë©´,** ëˆ„êµ°ê°€ì˜ ì‹¤ìˆ˜ë¡œ ì •ì˜ë˜ì§€ ì•Šì€ í˜•íƒœì˜ ë°ì´í„°ë¥¼ í•´ë‹¹ í† í”½ìœ¼ë¡œ ë³´ë‚¸ë‹¤ë©´, ê·¸ì™€ ì—°ê²°ëœ ëª¨ë“  ì‹œìŠ¤í…œì´ ì˜í–¥ì„ ë°›ê²Œ ë  ê²ƒì´ê³ , ì‹¬ê°í•œ ë¬¸ì œë¥¼ ì•¼ê¸°í•  ìˆ˜ ìˆë‹¤.
- ë°ì´í„°ë¥¼ ì»¨ìŠ˜í•˜ëŠ” ì—¬ëŸ¬ ë¶€ì„œì—ê²Œ ê·¸ ë°ì´í„°ì— ëŒ€í•œ ì •í™•í•œ ì •ì˜ì™€ ì˜ë¯¸ë¥¼ ì•Œë ¤ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒì´ **ìŠ¤í‚¤ë§ˆ**ì´ë‹¤.
- ì¹´í”„ì¹´ì—ì„œ ìŠ¤í‚¤ë§ˆì˜ ì§„í™”ë¥¼ ì§€ì›í•˜ì—¬, ì¹´í”„ì¹´ë¥¼ ì‚¬ìš©í•˜ëŠ” ìˆ˜ì‹­~ìˆ˜ë°±ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì´ ë³„ë‹¤ë¥¸ ì˜í–¥ ì—†ì´ ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
- ğŸ‘ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸°ì— ì•ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•˜ëŠ” ì‘ì—…ì—ëŠ” ë§ì€ ì‹œê°„ê³¼ ë…¸ë ¥ì´ ë“ ë‹¤. (í•˜ì§€ë§Œ ì´ë¥¼ ê°ìˆ˜í• ë§Œí¼ ì´ì ì´ ë§ìŒ)

<br/>

## 10.2 ì¹´í”„ì¹´ì™€ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬
### 10.2.1 ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ê°œìš”

<img alt="image" width=500 src="https://github.com/mash-up-kr/S3A/assets/55437339/912c034f-d2a7-4228-b7a6-2c216fe47d1d"/>

ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ êµ¬ì„±ë„
- ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” í”„ë¡œë“€ì„œ/ì»¨ìŠˆë¨¸ì™€ ì§ì ‘ í†µì‹ í•œë‹¤.
- í”„ë¡œë“€ì„œëŠ” ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìŠ¤í‚¤ë§ˆë¥¼ ë“±ë¡í•˜ê³ , ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” ë“±ë¡ëœ ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ì¹´í”„ì¹´ì˜ ë‚´ë¶€ í† í”½ì— ì €ì¥í•œë‹¤.
- í”„ë¡œë“€ì„œëŠ” ë“±ë¡ëœ ìŠ¤í‚¤ë§ˆì˜ IDì™€ ë©”ì‹œì§€ë¥¼ ì¹´í”„ì¹´ë¡œ ì „ì†¡í•˜ê³ , ì»¨ìŠˆë¨¸ëŠ” í”„ë¡œë“€ì„œê°€ ì „ì†¡í•œ ìŠ¤í‚¤ë§ˆ IDì™€ ë©”ì‹œì§€ë¥¼ ì¡°í•©í•´ ì½ì„ ìˆ˜ ìˆë‹¤.
- ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„œ ì§€ì›ë˜ëŠ” ë°ì´í„° í¬ë§·ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë°, `ì—ì´ë¸Œë¡œ`ê°€ ê°€ì¥ ëŒ€í‘œì ì´ë‹¤.

<br/>

### 10.2.2 ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ ì—ì´ë¸Œë¡œ ì§€ì›
- `ì—ì´ë¸Œë¡œ`: ì‹œìŠ¤í…œ, í”„ë¡œê·¸ë˜ë° ì–¸ì–´, í”„ë¡œì„¸ì‹± í”„ë ˆì„ì›Œí¬ ì‚¬ì´ì—ì„œ ë°ì´í„° êµí™˜ì„ ë„ì™€ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ì§ë ¬í™” ì‹œìŠ¤í…œ
  - ë¹ ë¥¸ ë°”ì´ë„ˆë¦¬ ë°ì´í„° í¬ë§·ì„ ì§€ì›í•œë‹¤.
  - JSON í˜•íƒœì˜ ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•  ìˆ˜ ìˆëŠ” ë§¤ìš° ê°„ê²°í•œ ë°ì´í„° í¬ë§·ì´ë‹¤.
 
- ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” ì—ì´ë¸Œë¡œ í¬ë§·ì„ ê°€ì¥ ë¨¼ì € ì§€ì›í–ˆê³ , ìµœê·¼ì—ëŠ” JSON, í”„ë¡œí† ì½œ ë²„í¼ í¬ë§·ë„ ì§€ì›í•œë‹¤.

<br/>

> **ìŠ¤í‚¤ë§ˆ ì˜ˆì œ íŒŒì¼ ìƒì„±**

```json
{
  "namespace": "student.avro", # ì´ë¦„ì„ ì‹ë³„í•˜ëŠ” ë¬¸ìì—´
  "type": "record", # ì—ì´ë¸Œë¡œëŠ” record, enums, arrays, maps ë“±ì„ ì§€ì›
  "doc": "Ths is an example of Avro", # ì‚¬ìš©ìë“¤ì—ê²Œ ì´ ìŠ¤í‚¤ë§ˆ ì •ì˜ì— ëŒ€í•œ ì„¤ëª… ì œê³µ
  "name": "Student", # ë ˆì½”ë“œì˜ ì´ë¦„ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´ (í•„ìˆ«ê°’)
  "fields": [ # JSON ë°°ì—´ë¡œì„œ, í•„ë“œë“¤ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ëœ»í•¨
    # name: í•„ë“œ ì´ë¦„, type: ë°ì´í„° íƒ€ì… ì •ì˜, doc: ì£¼ì„
    {"name": "name", "type": "string", "doc": "Name of the student"},
    {"name": "class", "type": "int", "doc": "Class of the student"}
  ]
}
```
ğŸ”¼ ì—ì´ë¸Œë¡œë¥¼ í™œìš©í•œ í•™ìƒ ëª…ë‹¨ì— ëŒ€í•œ ìŠ¤í‚¤ë§ˆ ì •ì˜ íŒŒì¼
- ë°ì´í„° í•„ë“œë§ˆë‹¤ ë°ì´í„° íƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- docë¥¼ ì´ìš©í•´ ê° í•„ë“œì˜ ì˜ë¯¸ë¥¼ ì‚¬ìš©ìë“¤ì—ê²Œ ì •í™•í•˜ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

<br/>

### 10.2.3 ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì¹˜
```
$ cd kafka2/
$ cd chapter2/ansible_playbook
$ ansible-playbook -i hosts kafka.yml
```
ğŸ”¼ ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„° ì„¤ì¹˜

<br/>

```
$ cd kakfa2/chapter2/ansible_playbook
$ ansible-playbook -i hosts site.yml
```
ğŸ”¼ ì£¼í‚¤í¼, ì¹´í”„ì¹´ ì¬ì„¤ì¹˜

<br/>

```
$ sudo wget http://packages.confluent.io/archive/6.1/confluent-community-6.1.0.tar.gz -0 /opt/confluent-community-6.1.0.tar.gz
$ sudo tar zxf /opt/confluent-community-6.1.0.tar.gz -C /usr/local
$ sudo ln -s /usr/local/confluent-6.1.0 /usr/local/confluent
```
ğŸ”¼ íŒŒì¼ ë‹¤ìš´ë¡œë“œ, ì••ì¶• í•´ì œ, ì‹¬ë³¼ë¦­ ë§í¬ ì„¤ì •

<br/>

```
vi /usr/local/confluent/etc/schema-registry/schema-registry.properties
```
ğŸ”¼ íŒŒì¼ ì—´ê¸°

<br/>

```
listeners=http://0.0.0.0:8081 # ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì‚¬ìš©í•  TCP í¬íŠ¸ë¥¼ 8081 í¬íŠ¸ë¡œ ì§€ì •
kafkastore.bootstrap.servers=PLAINTEXT://peter-kafka01.foo.bar:9092,peter-kafka02.foo.bar:9092,peter-kafka03.foo.bar:9092 # ìŠ¤í‚¤ë§ˆì˜ ë²„ì „ íˆìŠ¤í† ë¦¬ ë° ê´€ë ¨ ë°ì´í„°ë¥¼ ì €ì¥í•  ì¹´í”„ì¹´ ì£¼ì†Œë¥¼ ì…ë ¥
kafkastore.topic=_schemas # ìŠ¤í‚¤ë§ˆì˜ ë²„ì „ íˆìŠ¤í† ë¦¬ ë° ê´€ë ¨ ë°ì´í„° ì €ì¥ í† í”½ì˜ ì´ë¦„ì„ _schemasë¡œ ì§€ì •
schema.compatibility.level=full # ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ë ˆë²¨ì„ fullë¡œ ì„¤ì •
```
ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì˜µì…˜ ì„¤ì •

<br/>

```
$ sudo vi /etc/systemd/system/schema-registry.service
```
ğŸ”¼ ì½”ë“œë¶€ë¥¼ ì…ë ¥í•˜ê¸° ìœ„í•œ íŒŒì¼ ì—´ê¸°

<br/>

```
[Unit]
Description=schema registry
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/confluent/bin/schema-registry-start /usr/local/confluent/etc/schema-registry/schema-registry.properties
Restart=always

[Install]
WantedBy=multi-user.target
```
ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ system ì„¤ì •

<br/>

```
$ sudo systemctl daemon-reload
$ sudo systemctl start schema-registry
```
ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì‹¤í–‰

<br/>

|ì˜µì…˜|ì„¤ëª…|
|---|---|
|GET /schemas|í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡ëœ ì „ì²´ ìŠ¤í‚¤ë§ˆ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ|
|GET /schemas/ids/id|ìŠ¤í‚¤ë§ˆ IDë¡œ ì¡°íšŒ|
|GET /schemas/ids/id/versions|ìŠ¤í‚¤ë§ˆ IDì˜ ë²„ì „|
|GET /subjects|ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡ëœ subject ë¦¬ìŠ¤íŠ¸<br/>subjectëŠ” í† í”½ì´ë¦„-key, í† í”½ì´ë¦„-value í˜•íƒœë¡œ ì“°ì„|
|GET /subjects/ì„œë¸Œì íŠ¸ ì´ë¦„/versions|íŠ¹ì • ì„œë¸Œì íŠ¸ì˜ ë²„ì „ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ|
|GET /config|ì „ì—­ìœ¼ë¡œ ì„¤ì •ëœ í˜¸í™˜ì„± ë ˆë²¨ ì¡°íšŒ|
|GET /config/ì„œë¸Œì íŠ¸ ì´ë¦„|ì„œë¸Œì íŠ¸ì— ì„¤ì •ëœ í˜¸í™˜ì„± ì¡°íšŒ|
|DELETE /subjects/ì„œë¸Œì íŠ¸ ì´ë¦„|íŠ¹ì • ì„œë¸Œì íŠ¸ ì „ì²´ ì‚­ì œ|
|DELETE /subjects/ì„œë¸Œì íŠ¸ ì´ë¦„/versions/ë²„ì „|íŠ¹ì • ì„œë¸Œì íŠ¸ì—ì„œ íŠ¹ì • ë²„ì „ë§Œ ì‚­ì œ|

ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ API

<br/>

## 10.3 ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì‹¤ìŠµ
### 10.3.1 ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì™€ í´ë¼ì´ì–¸íŠ¸ ë™ì‘

<img alt="image" width="600" src="https://github.com/mash-up-kr/S3A/assets/55437339/6c48e4a4-5564-4f69-a4f9-3a7c44ba1463"/>

ğŸ”¼ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì™€ í´ë¼ì´ì–¸íŠ¸ ë™ì‘
1. ì—ì´ë¸Œë¡œ í”„ë¡œë“€ì„œëŠ” ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ ìŠ¤í‚¤ë§ˆê°€ ìœ íš¨í•œì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•œë‹¤. (í™•ì¸ë˜ì§€ ì•Šìœ¼ë©´, ìŠ¤í‚¤ë§ˆ ë“±ë¡/ìºì‹œ)
2. ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” í˜„ ìŠ¤í‚¤ë§ˆê°€ ì €ì¥ì†Œì— ì €ì¥ëœ ìŠ¤í‚¤ë§ˆì™€ ë™ì¼í•œì§€, ì§„í™”í•œ ê²ƒì¸ì§€ í™•ì¸í•œë‹¤. (ë¬¸ì œ ì—†ìœ¼ë©´ í”„ë¡œë“€ì„œì—ê²Œ ê³ ìœ  ID ì‘ë‹µ)
3. í”„ë¡œë“€ì„œëŠ” ë°›ì€ ìŠ¤í‚¤ë§ˆ IDë¥¼ ì°¸ê³ í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ì¹´í”„ì¹´ë¡œ ì „ì†¡í•œë‹¤.
4. ì—ì´ë¸Œë¡œ ì»¨ìŠˆë¨¸ëŠ” ìŠ¤í‚¤ë§ˆ IDë¡œ í† í”½ì— ì €ì¥ëœ ë©”ì‹œì§€ë¥¼ ì½ëŠ”ë‹¤. (ì»¨ìŠˆë¨¸ì—ê²Œ ìŠ¤í‚¤ë§ˆ IDê°€ ì—†ë‹¤ë©´ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ê°€ì ¸ì˜´)

<br/>

### 10.3.2 íŒŒì´ì¬ì„ ì´ìš©í•œ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ í™œìš©
```
$ sudo yum -y install python3
$ python3 -m venv venv10
$ source venv10/bin/activate
$ pip install confluent-kafka[avro]
```
ğŸ”¼ íŒŒì´ì¬ ì„¤ì¹˜, ê°€ìƒ í™˜ê²½(venv10) ìƒì„±, ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

<br/>

```python
# http://github.com/confluentinc/confluent-kafka-pyton
# avro ê´€ë ¨ ëª¨ë“ˆ ì„í¬íŠ¸
from confluent_kafka import avro
from confluent_kafka.avro import AvroProducer

# ìŠ¤í‚¤ë§ˆ ì •ì˜
value_schema_str = """
{ "namespace": "stduent.avro",
  "type": "record",
  "doc": "This is an example of Avro.",
  "name": "Student",
  "fields": [
    {"name": "name", "type": ["null", "string"], "default": null, "doc": "Name of the student"},
    {"name": "class", "type": "int", "default": 1, "doc": "Class of the student"}
  ]
}
"""
# ë°¸ë¥˜ ìŠ¤í‚¤ë§ˆ ë¡œë“œ
value_schema = avro.loads(value_schema_str)
value = {"name": "Peter", "class": 1} # ì „ì†¡í•  ë©”ì‹œì§€


# ì „ì†¡ ê²°ê³¼ í™•ì¸
def delivery_report(err, msg):
  """ Called once for each message produced to indicate delivery result.
      Triggered by poll() or flush(). """
  if err is not None:
    print('Message delivery failed: {}'.format(err))
  else:
    print('Message delivered to {} [{}]'.format(msg.topic(), msg.partition())

# AvroProducer ì†ì„± ì •ì˜
avroProducer = AvroProducer({
  'bootstrap.servers': 'peter-kafka01.foo.bar,peter-kafka02.foo.bar,peter-kafka03.foo.bar',
  'on_delivery': delivery_report,
  'schema.registry.url': 'http://peter-kafka03.foo.bar:8081'
  }, default_value_schema=value_schema)

# ë©”ì‹œì§€ ì „ì†¡
avroProducer.produce(topic='peter-avro2', value=value)
avroProducer.flush()
```
ğŸ”¼ ì—ì´ë¸Œë¡œ ë©”ì‹œì§€ ì „ì†¡ì„ ìœ„í•œ ê¸°ë³¸ íŒŒì´ì¬ ì—ì´ë¸Œë¡œ í”„ë¡œë“€ì„œ(python-avro-producer.py)

<br/>

```
$ python python-avro-producer.py

# ì¶œë ¥
Message delivered to peter-avro2 [0]
```
ğŸ”¼ í”„ë¡œë“€ì„œ ì‹¤í–‰

<br/>

```python
# http://github.com/confluentinc/confluent-kafka-pyton
# avro ê´€ë ¨ ëª¨ë“ˆ ì„í¬íŠ¸
from confluent_kafka import avro
from confluent_kafka.avro import AvroProducer
from confluent_kafka.avro.serializer import SerializerError

# ìŠ¤í‚¤ë§ˆ ì •ì˜
value_schema_str = """
{ "namespace": "stduent.avro",
  "type": "record",
  "doc": "This is an example of Avro.",
  "name": "Student",
  "fields": [
    {"name": "name", "type": ["null", "string"], "default": null, "doc": "Name of the student"},
    {"name": "class", "type": "int", "default": 1, "doc": "Class of the student"}
  ]
}
"""
# ë°¸ë¥˜ ìŠ¤í‚¤ë§ˆ ë¡œë“œ
value_schema = avro.loads(value_schema_str)

# AvroConsumer ì†ì„± ì •ì˜
c = AvroConsumer({
  'bootstrap.servers': 'peter-kafka01.foo.bar,peter-kafka02.foo.bar,peter-kafka03.foo.bar',
  'group.id': 'python-groupid01',
  'auto.offset.reset': 'earliest',
  'schema.registry.url': 'http://peter-kafka03.foo.bar:8081'}, reader_value_schema=value_schema)

# í† í”½ êµ¬ë…
c.subscribe(['peter-avro2'])

# ë©”ì‹œì§€ ì»¨ìŠ˜
while True:
  try:
    msg = c.poll(10)

  except SerializerError as e:
    print("Message deserialization failed for {}: {}".format(msg, e))
    break

  if msg is None:
    continue

  if msg.error():
    print("AvroConsumer error: {}".format(msg.error()))
    continue
    print(msg.value())

# ì¢…ë£Œ
c.close()
```
ğŸ”¼ ì—ì´ë¸Œë¡œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ê¸°ë³¸ íŒŒì´ì¬ ì—ì´ë¸Œë¡œ ì»¨ìŠˆë¨¸(python-avro-consumer.py)
- peter-avro2 í† í”½ì„ ì»¨ìŠ˜í•œë‹¤.
- ì»¨ìŠˆë¨¸ ê·¸ë£¹ IDëŠ” python-groupid01ë¡œ ì²˜ìŒ ì˜¤í”„ì…‹ë¶€í„° ë©”ì‹œì§€ë¥¼ ì½ì–´ì˜¨ë‹¤.

<br/>

```
$ python python-avro-consumer.py

# ì¶œë ¥
{'name': 'Peter', 'class': 1}
```
ğŸ”¼ ì»¨ìŠˆë¨¸ ì‹¤í–‰

<br/>

```
$ curl http://peter-kafka03.foo.bar:8081/schemas | python -m json.tool
```
- ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ APIë¥¼ ì´ìš©í•´ ìŠ¤í‚¤ë§ˆê°€ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì˜ ê¸°ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br/>

```python
#
```
ğŸ”¼ ìŠ¤í‚¤ë§ˆë¥¼ ì¬ì •ì˜í•œ íŒŒì´ì¬ ì—ì´ë¸Œë¡œ í”„ë¡œë“€ì„œ(python-avro.producer2.py)
- ìŠ¤í‚¤ë§ˆì˜ name í•„ë“œë¥¼ ì‚­ì œí•˜ê³ , first_nameê³¼ last_nameì´ë¼ëŠ” 2ê°œì˜ í•„ë“œë¥¼ ì¶”ê°€í•œë‹¤.
- ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ ë¹„êµì  ê°„ë‹¨í•˜ê²Œ ë³€ê²½ëœ ë‚´ìš©ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
